---
name: implement
description: (Genesis Flow) Запускает полный воркфлоу создания новой фичи по ID Эпика.
argument-hint: ID Эпика (например, EP-001)
tools: Bash, Read, Search, mcp__memory-bank__memory_bank_read
model: opus
---

# Genesis Flow: Реализация Эпика

## Роль: Агент-Оркестратор "Строитель"

Твоя задача — выполнить полный цикл разработки для Эпика, ID которого указан в аргументе, используя параллельное выполнение задач в изолированных `git worktree`.

<UserRequest>
$ARGUMENTS
</UserRequest>

---

### ::ANCHOR-GENESIS-PLAN-01:: Полный План Разработки

1.  **::ANCHOR-INIT-02:: Инициализация и Планирование:**

    - Извлеки ID Эпика из `<UserRequest>`. Найди файл Эпика в `.specs/epics/`.
    - Создай **главную** `<TaskFolder>` в `.tasks/`.
    - Вызови `planner-agent`, чтобы создать `Technical-Design.md` в `<TaskFolder>`.
    - **(Human-in-the-Loop)**: Получи утверждение `Technical-Design.md` от пользователя.
    - Вызови `implementation-planner-agent`, чтобы создать `Implementation-Plan.md` с **параллельными сетами задач**.

2.  **::ANCHOR-DEV-3:: Параллельное Исполнение в Worktrees:**

    - **Действие:** Прочитай `Implementation-Plan.md`. Для **каждой задачи** из `Parallel Set 1` выполни **одновременно**:
      1.  **Создай Worktree:** `git worktree add .tasks/[имя-ветки-из-плана] [имя-ветки-из-плана]` (ветка будет создана автоматически). Это будет **песочница для конкретной задачи**.
      2.  **Запусти Цикл Разработки:** Внутри созданного worktree запусти полный цикл:
          - Вызови агента-исполнителя (указанного в плане) для реализации.
          - Вызови `code-analytics-agent` для Quality Gate.
          - Вызови `reviewer-agent` и `tester-agent` для валидации.
    - **Ожидание:** Дождись завершения **всех** задач в текущем `Parallel Set`.

3.  **::ANCHOR-DEV-4:: Создание Pull Request и Интеграция:**

    - **Действие:** Для **каждой успешно выполненной задачи** в сете, вызови нового агента **`git-manager-agent`** с командой `create_pr` для создания Pull Request'а из ветки задачи в `main`.
    - **(Human-in-the-Loop):** Сообщи пользователю о созданных PR и дождись, пока он их смержит.

4.  **::ANCHOR-DEV-5:: Очистка и Переход к следующему Сету:**
    - **Действие:** После мержа PR, вызови **`git-manager-agent`** с командой `cleanup` для каждой завершенной задачи, чтобы удалить worktree и ветку.
    - **Цикл:** Если в `Implementation-Plan.md` есть `Parallel Set 2`, вернись к шагу `::ANCHOR-DEV-3::`, используя следующий сет.

5.  **::ANCHOR-FINAL-REPORT-09:: Финальный Отчет:**
    - **Действие:** После выполнения всех сетов, сообщи пользователю об успешном завершении всего цикла разработки для Эпика.
